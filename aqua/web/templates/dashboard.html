<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Security Dashboard - Aqua IoT Security Platform</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link rel="stylesheet" href="/static/css/styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/apexcharts@3.44.0/dist/apexcharts.min.js"></script>
    <!-- Add Three.js for 3D network visualization -->
    <script src="https://cdn.jsdelivr.net/npm/three@0.158.0/build/three.min.js"></script>
    <!-- OrbitControls from jsm path -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Create a script element for OrbitControls
            const script = document.createElement('script');
            script.src = 'https://cdn.jsdelivr.net/npm/three@0.158.0/examples/js/controls/OrbitControls.js';
            script.onload = function() {
                console.log('OrbitControls loaded successfully');
                // After OrbitControls is loaded, initialize the network visualization if it exists
                if (window.networkViz && typeof THREE.OrbitControls !== 'undefined') {
                    console.log('Initializing network visualization with OrbitControls');
                    if (window.demoDevices && window.demoConnections) {
                        window.networkViz.loadData(window.demoDevices, window.demoConnections);
                    }
                }
            };
            script.onerror = function() {
                console.error('Failed to load OrbitControls');
                // Add error message to the network visualization container
                const container = document.getElementById('networkVisualization');
                if (container) {
                    container.innerHTML += `
                        <div class="alert alert-warning m-3">
                            <strong>Warning:</strong> Camera controls could not be loaded.
                            The visualization may still work but without interactive controls.
                        </div>
                    `;
                }
            };
            document.head.appendChild(script);
        });
    </script>
</head>
<body class="dashboard-body">
    <div class="wrapper">
        <!-- Sidebar -->
        <nav id="sidebar" class="sidebar">
            <div class="sidebar-header">
                <h3 class="logo-text">AQUA</h3>
                <small class="text-muted">Security Platform</small>
            </div>
            <div class="profile-section">
                <img src="https://www.gravatar.com/avatar/00000000000000000000000000000000?d=mp" alt="Profile" class="profile-img">
                <div class="profile-info">
                    <div class="profile-name">Admin User</div>
                    <div class="profile-role text-muted">Security Analyst</div>
                </div>
            </div>
            <ul class="list-unstyled components">
                <li class="active">
                    <a href="/" class="nav-link">
                        <i class="bi bi-speedometer2"></i> Dashboard
                    </a>
                </li>
                <li>
                    <a href="/devices" class="nav-link">
                        <i class="bi bi-hdd-network"></i> Devices
                    </a>
                </li>
                <li>
                    <a href="/vulnerabilities" class="nav-link">
                        <i class="bi bi-shield-exclamation"></i> Vulnerabilities
                    </a>
                </li>
                <li>
                    <a href="/reports" class="nav-link">
                        <i class="bi bi-file-earmark-bar-graph"></i> Reports
                    </a>
                </li>
                <li class="sidebar-section">Monitoring</li>
                <li>
                    <a href="#" class="nav-link">
                        <i class="bi bi-activity"></i> Live Activity
                    </a>
                </li>
                <li>
                    <a href="#" class="nav-link">
                        <i class="bi bi-bell"></i> Alerts
                    </a>
                </li>
                <li class="sidebar-section">Settings</li>
                <li>
                    <a href="/settings" class="nav-link">
                        <i class="bi bi-gear"></i> Settings
                    </a>
                </li>
                <li>
                    <a href="#" class="nav-link">
                        <i class="bi bi-question-circle"></i> Help & Support
                    </a>
                </li>
            </ul>

            <div class="sidebar-footer">
                <div class="theme-toggle">
                    <i class="bi bi-moon-stars"></i>
                    <div class="form-check form-switch">
                        <input class="form-check-input" type="checkbox" id="darkModeToggle">
                    </div>
                    <i class="bi bi-brightness-high"></i>
                </div>
            </div>
        </nav>

        <!-- Page Content -->
        <div id="content">
            <!-- Top Navigation -->
            <nav class="navbar navbar-expand-lg">
                <div class="container-fluid">
                    <button type="button" id="sidebarCollapse" class="btn">
                        <i class="bi bi-list"></i>
                    </button>
                    
                    <div class="search-bar">
                        <i class="bi bi-search"></i>
                        <input type="text" placeholder="Search for devices, vulnerabilities...">
                    </div>

                    <div class="navbar-right">
                        <div class="dropdown notification-dropdown">
                            <button class="btn dropdown-toggle no-arrow" type="button" id="notificationDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                                <i class="bi bi-bell"></i>
                                <span class="notification-badge">3</span>
                            </button>
                            <ul class="dropdown-menu notification-menu" aria-labelledby="notificationDropdown">
                                <li class="notification-header">
                                    <h6>Notifications</h6>
                                    <a href="#" class="text-muted">Mark all as read</a>
                                </li>
                                <div class="notification-body" id="notificationsContainer">
                                    <!-- Notifications will be loaded here -->
                                </div>
                                <li class="notification-footer">
                                    <a href="#" class="text-center d-block">View all notifications</a>
                                </li>
                            </ul>
                        </div>
                        <div class="dropdown">
                            <button class="btn dropdown-toggle" type="button" id="profileDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                                <img src="https://www.gravatar.com/avatar/00000000000000000000000000000000?d=mp" alt="Profile" class="profile-img-sm">
                            </button>
                            <ul class="dropdown-menu" aria-labelledby="profileDropdown">
                                <li><a class="dropdown-item" href="#"><i class="bi bi-person"></i> Profile</a></li>
                                <li><a class="dropdown-item" href="#"><i class="bi bi-gear"></i> Settings</a></li>
                                <li><hr class="dropdown-divider"></li>
                                <li><a class="dropdown-item" href="#"><i class="bi bi-box-arrow-right"></i> Logout</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </nav>

            <!-- Advanced Security Dashboard -->
            <div class="container-fluid dashboard-container">
                <!-- Security Summary Section -->
                <div class="row mb-4">
                    <div class="col">
                        <h1 class="dashboard-title">Security Dashboard</h1>
                        <p class="text-muted">Real-time security monitoring and analytics</p>
                    </div>
                    <div class="col-auto">
                        <div class="dashboard-actions">
                            <button class="btn btn-outline-secondary me-2">
                                <i class="bi bi-download"></i> Export
                            </button>
                            <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#newScanModal">
                                <i class="bi bi-play-fill"></i> New Scan
                            </button>
                        </div>
                    </div>
                </div>

                <!-- 3D Network Visualization -->
                <div class="row mb-4">
                    <div class="col-12">
                        <div class="card dashboard-card">
                            <div class="card-header">
                                <h5 class="card-title">Network Topology & Threat Map</h5>
                                <div class="card-actions">
                                    <button class="btn btn-sm btn-outline-secondary me-2">
                                        <i class="bi bi-arrows-fullscreen"></i>
                                    </button>
                                    <div class="dropdown">
                                        <button class="btn btn-sm btn-outline-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown">
                                            View Options
                                        </button>
                                        <ul class="dropdown-menu">
                                            <li><a class="dropdown-item" href="#">2D View</a></li>
                                            <li><a class="dropdown-item" href="#">3D View</a></li>
                                            <li><a class="dropdown-item" href="#">Traffic Heatmap</a></li>
                                            <li><hr class="dropdown-divider"></li>
                                            <li><a class="dropdown-item" href="#">Device Groups</a></li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <div class="card-body">
                                <div id="networkVisualization" style="height: 400px; background: linear-gradient(to bottom, #1e3a5c, #12263f); border-radius: 0.5rem; position: relative; overflow: hidden;">
                                    <!-- 3D Visualization will be rendered here -->
                                </div>
                            </div>
                            <div class="card-footer bg-transparent">
                                <div class="d-flex justify-content-between">
                                    <div>
                                        <span class="badge bg-primary me-2">5 Network Segments</span>
                                        <span class="badge bg-success me-2">12 Active Connections</span>
                                        <span class="badge bg-danger">3 Potential Threats</span>
                                    </div>
                                    <div>
                                        <span class="text-muted">Last updated: Just now</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Advanced Analytics Section -->
                <div class="row mb-4">
                    <div class="col-md-8">
                        <div class="card dashboard-card">
                            <div class="card-header">
                                <h5 class="card-title">Advanced Threat Analysis</h5>
                                <div class="card-actions">
                                    <div class="btn-group">
                                        <button type="button" class="btn btn-sm btn-outline-secondary active">Day</button>
                                        <button type="button" class="btn btn-sm btn-outline-secondary">Week</button>
                                        <button type="button" class="btn btn-sm btn-outline-secondary">Month</button>
                                    </div>
                                </div>
                            </div>
                            <div class="card-body">
                                <div id="threatAnalysisChart" style="height: 300px;"></div>
                            </div>
                            <div class="card-footer bg-transparent">
                                <div class="row">
                                    <div class="col-md-3">
                                        <div class="d-flex align-items-center">
                                            <div style="width: 12px; height: 12px; background-color: #e63757; margin-right: 8px; border-radius: 2px;"></div>
                                            <div class="me-auto">Brute Force Attacks</div>
                                            <div class="fw-bold">24</div>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="d-flex align-items-center">
                                            <div style="width: 12px; height: 12px; background-color: #fd7e14; margin-right: 8px; border-radius: 2px;"></div>
                                            <div class="me-auto">Unauthorized Access</div>
                                            <div class="fw-bold">17</div>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="d-flex align-items-center">
                                            <div style="width: 12px; height: 12px; background-color: #f6c343; margin-right: 8px; border-radius: 2px;"></div>
                                            <div class="me-auto">Data Exfiltration</div>
                                            <div class="fw-bold">8</div>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="d-flex align-items-center">
                                            <div style="width: 12px; height: 12px; background-color: #39afd1; margin-right: 8px; border-radius: 2px;"></div>
                                            <div class="me-auto">Malware Detected</div>
                                            <div class="fw-bold">12</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card dashboard-card h-100">
                            <div class="card-header">
                                <h5 class="card-title">AI-Assisted Recommendations</h5>
                            </div>
                            <div class="card-body">
                                <div class="recommendation-item">
                                    <div class="recommendation-header">
                                        <div class="recommendation-icon critical">
                                            <i class="bi bi-shield-exclamation"></i>
                                        </div>
                                        <div class="recommendation-title">Update Router Firmware</div>
                                    </div>
                                    <div class="recommendation-body">
                                        Router (192.168.1.104) is running outdated firmware with 4 known vulnerabilities.
                                    </div>
                                    <div class="recommendation-actions">
                                        <button class="btn btn-sm btn-outline-primary">View Details</button>
                                        <button class="btn btn-sm btn-success">Apply Fix</button>
                                    </div>
                                </div>
                                <div class="recommendation-item">
                                    <div class="recommendation-header">
                                        <div class="recommendation-icon high">
                                            <i class="bi bi-lock"></i>
                                        </div>
                                        <div class="recommendation-title">Change Default Credentials</div>
                                    </div>
                                    <div class="recommendation-body">
                                        3 devices are using default manufacturer credentials.
                                    </div>
                                    <div class="recommendation-actions">
                                        <button class="btn btn-sm btn-outline-primary">View Devices</button>
                                        <button class="btn btn-sm btn-success">Fix All</button>
                                    </div>
                                </div>
                                <div class="recommendation-item">
                                    <div class="recommendation-header">
                                        <div class="recommendation-icon medium">
                                            <i class="bi bi-hdd-network"></i>
                                        </div>
                                        <div class="recommendation-title">Segment IoT Network</div>
                                    </div>
                                    <div class="recommendation-body">
                                        Create a separate network segment for IoT devices to enhance security.
                                    </div>
                                    <div class="recommendation-actions">
                                        <button class="btn btn-sm btn-outline-primary">Learn More</button>
                                        <button class="btn btn-sm btn-success">Apply</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Realtime Monitoring Section -->
                <div class="row mb-4">
                    <div class="col-md-8">
                        <div class="card dashboard-card">
                            <div class="card-header">
                                <h5 class="card-title">Realtime Security Events</h5>
                                <div class="card-actions">
                                    <span class="badge bg-success pulse-animation">Live</span>
                                </div>
                            </div>
                            <div class="card-body p-0">
                                <div class="security-events-timeline">
                                    <div class="security-event">
                                        <div class="security-event-time">11:42 AM</div>
                                        <div class="security-event-icon warning">
                                            <i class="bi bi-exclamation-triangle"></i>
                                        </div>
                                        <div class="security-event-content">
                                            <div class="security-event-title">Unusual Traffic Detected</div>
                                            <div class="security-event-details">Camera (192.168.1.101) sending data to external IP (103.45.67.89)</div>
                                            <div class="security-event-actions">
                                                <button class="btn btn-sm btn-outline-primary">Analyze</button>
                                                <button class="btn btn-sm btn-danger">Block</button>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="security-event">
                                        <div class="security-event-time">11:38 AM</div>
                                        <div class="security-event-icon info">
                                            <i class="bi bi-shield-check"></i>
                                        </div>
                                        <div class="security-event-content">
                                            <div class="security-event-title">Scan Completed</div>
                                            <div class="security-event-details">Weekly security scan completed with 2 new vulnerabilities found</div>
                                            <div class="security-event-actions">
                                                <button class="btn btn-sm btn-outline-primary">View Report</button>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="security-event">
                                        <div class="security-event-time">11:15 AM</div>
                                        <div class="security-event-icon critical">
                                            <i class="bi bi-exclamation-octagon"></i>
                                        </div>
                                        <div class="security-event-content">
                                            <div class="security-event-title">Login Attempt Failed</div>
                                            <div class="security-event-details">Multiple failed login attempts on Router (192.168.1.104) from IP 192.168.1.35</div>
                                            <div class="security-event-actions">
                                                <button class="btn btn-sm btn-outline-primary">Investigate</button>
                                                <button class="btn btn-sm btn-danger">Block Source</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="card-footer bg-transparent text-center">
                                <button class="btn btn-sm btn-link">View All Events</button>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card dashboard-card">
                            <div class="card-header">
                                <h5 class="card-title">Security Automation Hub</h5>
                            </div>
                            <div class="card-body">
                                <div class="automation-item">
                                    <div class="form-check form-switch automation-switch">
                                        <input class="form-check-input" type="checkbox" id="autoBlockToggle" checked>
                                        <label class="form-check-label" for="autoBlockToggle">Auto-Block Suspicious Traffic</label>
                                    </div>
                                    <div class="automation-description">
                                        Automatically block traffic that matches known malicious patterns
                                    </div>
                                </div>
                                <div class="automation-item">
                                    <div class="form-check form-switch automation-switch">
                                        <input class="form-check-input" type="checkbox" id="autoUpdateToggle" checked>
                                        <label class="form-check-label" for="autoUpdateToggle">Auto-Update Vulnerability Database</label>
                                    </div>
                                    <div class="automation-description">
                                        Keep threat intelligence database updated automatically
                                    </div>
                                </div>
                                <div class="automation-item">
                                    <div class="form-check form-switch automation-switch">
                                        <input class="form-check-input" type="checkbox" id="autoAlertToggle" checked>
                                        <label class="form-check-label" for="autoAlertToggle">Critical Alerts to Email</label>
                                    </div>
                                    <div class="automation-description">
                                        Send critical security alerts to registered email addresses
                                    </div>
                                </div>
                                <div class="automation-item">
                                    <div class="form-check form-switch automation-switch">
                                        <input class="form-check-input" type="checkbox" id="autoQuarantineToggle">
                                        <label class="form-check-label" for="autoQuarantineToggle">Auto-Quarantine Compromised Devices</label>
                                    </div>
                                    <div class="automation-description">
                                        Isolate devices that show signs of compromise
                                    </div>
                                </div>
                                <div class="mt-3">
                                    <button class="btn btn-primary btn-sm w-100">
                                        <i class="bi bi-gear"></i> Manage Automations
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Footer -->
            <footer class="dashboard-footer">
                <div>Aqua IoT Security Platform &copy; 2023</div>
                <div>Version 1.0.0</div>
            </footer>
        </div>
    </div>

    <!-- New Scan Modal -->
    <div class="modal fade" id="newScanModal" tabindex="-1" aria-labelledby="newScanModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="newScanModalLabel">Start New Security Scan</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="newScanForm">
                        <div class="mb-3">
                            <label for="scanTarget" class="form-label">Target Network/IP</label>
                            <input type="text" class="form-control" id="scanTarget" name="target" placeholder="192.168.1.0/24">
                        </div>
                        <div class="mb-3">
                            <label for="scanName" class="form-label">Scan Name (Optional)</label>
                            <input type="text" class="form-control" id="scanName" name="name" placeholder="Home Network Weekly Scan">
                        </div>
                        <div class="mb-3">
                            <label for="scanType" class="form-label">Scan Type</label>
                            <select class="form-select" id="scanType" name="scan_type">
                                <option value="quick">Quick Scan</option>
                                <option value="full">Full Scan</option>
                                <option value="vuln">Vulnerability Scan</option>
                                <option value="discovery">Discovery Only</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="scanPorts" class="form-label">Ports</label>
                            <input type="text" class="form-control" id="scanPorts" name="ports" value="1-1000">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" id="startScanBtn">Start Scan</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scan Progress Modal -->
    <div class="modal fade" id="scanProgressModal" tabindex="-1" aria-labelledby="scanProgressModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="scanProgressModalLabel">
                        <i class="bi bi-shield-check me-2"></i>Scan in Progress
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="text-center mb-3">
                        <div class="scan-progress-circle">
                            <div class="progress-ring">
                                <svg>
                                    <circle class="progress-ring-circle-bg" cx="60" cy="60" r="50"></circle>
                                    <circle class="progress-ring-circle" cx="60" cy="60" r="50"></circle>
                                </svg>
                                <div class="progress-text">0%</div>
                            </div>
                        </div>
                        <h5 id="scanProgressText" class="mt-3">Starting scan...</h5>
                    </div>

                    <!-- Scan Steps -->
                    <div class="scan-steps mb-4">
                        <div class="scan-step active" data-step="1" data-label="Discovery"></div>
                        <div class="scan-step" data-step="2" data-label="Ports"></div>
                        <div class="scan-step" data-step="3" data-label="Vulnerabilities"></div>
                        <div class="scan-step" data-step="4" data-label="Analysis"></div>
                        <div class="scan-step" data-step="5" data-label="Complete"></div>
                    </div>

                    <div class="scan-info">
                        <div class="scan-target">
                            <strong>Target:</strong>
                            <span id="scanProgressTarget">192.168.1.0/24</span>
                        </div>
                        <div class="scan-type">
                            <strong>Type:</strong>
                            <span id="scanProgressType">Full Scan</span>
                        </div>
                        <div class="scan-status">
                            <strong>Status:</strong>
                            <span id="scanProgressStatus">Running</span>
                        </div>
                        <div class="scan-time">
                            <strong>Started:</strong>
                            <span id="scanProgressTime">Just now</span>
                        </div>
                    </div>

                    <div class="mt-3">
                        <h6>
                            <i class="bi bi-terminal me-2"></i>Scan Log
                        </h6>
                        <div id="scanLogContainer" class="scan-log-container">
                            <!-- Log entries will be added dynamically -->
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="bi bi-x me-1"></i>Close
                    </button>
                    <button type="button" class="btn btn-danger" id="cancelScanBtn">
                        <i class="bi bi-stop-fill me-1"></i>Cancel Scan
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/static/js/dashboard.js"></script>
    <script src="/static/js/network-visualization.js"></script>
    
    <!-- Custom initialization script for this page -->
    <script>
        // Initialize ApexCharts for the threat analysis
        document.addEventListener('DOMContentLoaded', function() {
            const threatChart = new ApexCharts(document.getElementById('threatAnalysisChart'), {
                series: [{
                    name: 'Brute Force',
                    data: [3, 7, 5, 2, 8, 10, 5]
                }, {
                    name: 'Unauthorized Access',
                    data: [2, 4, 6, 4, 3, 5, 2]
                }, {
                    name: 'Data Exfiltration',
                    data: [0, 3, 2, 0, 1, 2, 3]
                }, {
                    name: 'Malware',
                    data: [5, 2, 1, 3, 2, 4, 1]
                }],
                chart: {
                    type: 'area',
                    height: 300,
                    toolbar: {
                        show: false
                    },
                    animations: {
                        enabled: true,
                        easing: 'easeinout',
                        speed: 800
                    }
                },
                colors: ['#e63757', '#fd7e14', '#f6c343', '#39afd1'],
                dataLabels: {
                    enabled: false
                },
                stroke: {
                    curve: 'smooth',
                    width: 2
                },
                fill: {
                    type: 'gradient',
                    gradient: {
                        opacityFrom: 0.6,
                        opacityTo: 0.1
                    }
                },
                xaxis: {
                    categories: ['6:00 AM', '8:00 AM', '10:00 AM', '12:00 PM', '2:00 PM', '4:00 PM', '6:00 PM'],
                    labels: {
                        style: {
                            colors: '#95aac9'
                        }
                    }
                },
                yaxis: {
                    labels: {
                        style: {
                            colors: '#95aac9'
                        }
                    }
                },
                legend: {
                    position: 'top',
                    horizontalAlign: 'right'
                },
                tooltip: {
                    x: {
                        format: 'dd/MM/yy HH:mm'
                    }
                }
            });
            
            threatChart.render();
            
            // Add pulse animation to live badge
            const style = document.createElement('style');
            style.innerHTML = `
                @keyframes pulse {
                    0% {
                        transform: scale(1);
                        opacity: 1;
                    }
                    50% {
                        transform: scale(1.05);
                        opacity: 0.8;
                    }
                    100% {
                        transform: scale(1);
                        opacity: 1;
                    }
                }
                
                .pulse-animation {
                    animation: pulse 1.5s infinite;
                }
                
                .security-events-timeline {
                    padding: 15px;
                }
                
                .security-event {
                    display: flex;
                    margin-bottom: 15px;
                    padding-bottom: 15px;
                    border-bottom: 1px solid var(--color-border);
                }
                
                .security-event:last-child {
                    margin-bottom: 0;
                    padding-bottom: 0;
                    border-bottom: none;
                }
                
                .security-event-time {
                    color: var(--color-text-secondary);
                    font-size: 0.8rem;
                    width: 60px;
                    padding-top: 5px;
                }
                
                .security-event-icon {
                    width: 36px;
                    height: 36px;
                    border-radius: 50%;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    color: white;
                    margin-right: 15px;
                    flex-shrink: 0;
                }
                
                .security-event-icon.info {
                    background-color: var(--blue);
                }
                
                .security-event-icon.warning {
                    background-color: var(--yellow);
                }
                
                .security-event-icon.critical {
                    background-color: var(--red);
                }
                
                .security-event-content {
                    flex-grow: 1;
                }
                
                .security-event-title {
                    font-weight: 600;
                    margin-bottom: 3px;
                }
                
                .security-event-details {
                    color: var(--color-text-secondary);
                    font-size: 0.9rem;
                    margin-bottom: 8px;
                }
                
                .security-event-actions {
                    display: flex;
                    gap: 5px;
                }
                
                .recommendation-item {
                    padding: 15px;
                    border: 1px solid var(--color-border);
                    border-radius: 8px;
                    margin-bottom: 15px;
                    transition: all 0.3s;
                }
                
                .recommendation-item:hover {
                    box-shadow: var(--shadow-sm);
                    transform: translateY(-2px);
                }
                
                .recommendation-header {
                    display: flex;
                    align-items: center;
                    margin-bottom: 10px;
                }
                
                .recommendation-icon {
                    width: 36px;
                    height: 36px;
                    border-radius: 50%;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    color: white;
                    margin-right: 10px;
                }
                
                .recommendation-icon.critical {
                    background-color: var(--red);
                }
                
                .recommendation-icon.high {
                    background-color: var(--orange);
                }
                
                .recommendation-icon.medium {
                    background-color: var(--yellow);
                }
                
                .recommendation-title {
                    font-weight: 600;
                }
                
                .recommendation-body {
                    color: var(--color-text-secondary);
                    font-size: 0.9rem;
                    margin-bottom: 10px;
                }
                
                .recommendation-actions {
                    display: flex;
                    justify-content: flex-end;
                    gap: 5px;
                }
                
                .automation-item {
                    margin-bottom: 15px;
                    padding-bottom: 15px;
                    border-bottom: 1px solid var(--color-border);
                }
                
                .automation-item:last-child {
                    margin-bottom: 15px;
                    padding-bottom: 0;
                    border-bottom: none;
                }
                
                .automation-switch {
                    margin-bottom: 5px;
                }
                
                .automation-description {
                    color: var(--color-text-secondary);
                    font-size: 0.85rem;
                }
            `;
            
            document.head.appendChild(style);
        });

        // Add demo data for visualization
        document.addEventListener('DOMContentLoaded', function() {
            // Demo devices data for the 3D visualization
            window.demoDevices = [
                { id: "dev_1", ip: "192.168.1.101", hostname: "iot-camera-01", device_type: "camera", manufacturer: "SecurityCam", is_online: true, vulnerabilities: [{ severity: "high" }] },
                { id: "dev_2", ip: "192.168.1.102", hostname: "smart-thermostat", device_type: "thermostat", manufacturer: "SmartHome", is_online: true, vulnerabilities: [{ severity: "medium" }] },
                { id: "dev_3", ip: "192.168.1.103", hostname: "smart-lock", device_type: "lock", manufacturer: "SecureLock", is_online: true, vulnerabilities: [{ severity: "high" }] },
                { id: "dev_4", ip: "192.168.1.104", hostname: "router", device_type: "router", manufacturer: "NetLink", is_online: true, vulnerabilities: [{ severity: "critical" }] },
                { id: "dev_5", ip: "192.168.1.105", hostname: "smart-tv", device_type: "tv", manufacturer: "SmartView", is_online: true, vulnerabilities: [] },
                { id: "dev_6", ip: "192.168.1.106", hostname: "smart-speaker", device_type: "speaker", manufacturer: "EchoTech", is_online: true, vulnerabilities: [] }
            ];
            
            // Demo connections for the network visualization
            window.demoConnections = [
                { source: "192.168.1.101", destination: "192.168.1.104", protocol: "TCP", state: "ESTABLISHED" },
                { source: "192.168.1.102", destination: "192.168.1.104", protocol: "TCP", state: "ESTABLISHED" },
                { source: "192.168.1.103", destination: "192.168.1.104", protocol: "TCP", state: "ESTABLISHED" },
                { source: "192.168.1.105", destination: "192.168.1.104", protocol: "TCP", state: "ESTABLISHED" },
                { source: "192.168.1.106", destination: "192.168.1.104", protocol: "TCP", state: "ESTABLISHED" },
                { source: "192.168.1.101", destination: "192.168.1.102", protocol: "UDP", state: "ESTABLISHED", isVulnerable: true }
            ];
            
            // Initialize the visualization
            if (window.networkViz) {
                window.networkViz.loadData(window.demoDevices, window.demoConnections);
            }
        });
    </script>
</body>
</html>
